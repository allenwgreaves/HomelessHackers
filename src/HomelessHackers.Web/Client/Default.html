<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="../Scripts/jquery-1.7.1.min.js"></script>
    <script src="../Scripts/knockout-2.1.0.js"></script>

    <script type="text/javascript">
        function OrganizationViewModel()
        {
            var self = this;
            self.Organizations = ko.observableArray([]);
            self.NewOrganization = ko.observable();
            self.GetOrganizations = function () {
                $.getJSON("/api/organizations/", null, function (data){
                    self.Organizations(data);
                });
            };
            self.SaveOrganization = function () {
                $.ajax({
                    type: "POST",
                    url: "/api/organizations/",
                    data: self.NewOrganization(),
                    dataType: "Organization",
                    success: function (msg) {
                        alert("I did it: " + msg);
                    }
                });
            };
        }
        $(document).ready(function () {

            var viewmodel = new OrganizationViewModel();

            viewmodel.GetOrganizations();

            ko.applyBindings(viewmodel);
                
        });

    </script>
</head>
<body>
    <ul data-bind="foreach: Organizations">
        <li data-bind="text: Name"></li>
    </ul>

    <form data-bind="with: NewOrganization, submit: SaveOrganization">
        Name: <input type="text" data-bind="value: Name" />
        <button type="submit" />
    </form>
</body>
</html>